function createField(e,t,i,a,n){var o=Ti.UI.createView({width:300,height:80,top:e}),r=Ti.UI.createLabel({font:{fontSize:10},color:"#666666",text:t,top:0,height:20,left:0});o.add(r);var d=Ti.UI.createTextField({width:300,top:25,height:40,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,paddingLeft:5,paddingRight:5});if(o.add(d),0!=a){d.paddingLeft=35;var a=Ti.UI.createImageView({left:10,image:a});switch(d.add(a),i){case"date":a.width=23,a.height=25,d.enabled=!1}}if("number"==i&&(d.keyboardType=Ti.UI.KEYBOARD_NUMBER_PAD),0!=n&&("date"==i||"time"==i)){d.paddingRight=35;var n=Ti.UI.createImageView({right:10,image:n,width:13,height:8});d.add(n)}return o.input=d,o}function saveMedication(e,t,i,a,n,o){var r=win.medicationsArrayOrdered,d='<?xml version="1.0" encoding="UTF-8"?><medications>';for(var c in r){var l=r[c];d+="<medication>",d+="<id>"+l.id+"</id>",d+="<name>"+l.name+"</name>",d+="<dosage>"+l.dosage+"</dosage>",d+="<usage>"+l.usage+"</usage>",d+="<withmeals>"+l.withmeals+"</withmeals>",d+="<date>"+l.date+"</date>",d+="<phone>"+l.phone+"</phone>",d+="</medication>"}d+="<medication>",d+="<id>"+(r.length+1)+"</id>",d+="<name>"+e+"</name>",d+="<dosage>"+t+"</dosage>",d+="<usage>"+i+"</usage>",d+="<withmeals>"+a+"</withmeals>",d+="<date>"+n+"</date>",d+="<phone>"+o+"</phone>",d+="</medication>",d+="</medications>";var s=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"/medications.xml");createFileIfNotExist(s),s.write(d)}function editMedication(e,t,i){var a='<?xml version="1.0" encoding="UTF-8"?><medications>';for(var n in medicationsArrayOrdered){var o=medicationsArrayOrdered[n];a+="<medication>",a+="<id>"+o.id+"</id>",e==o.id?(a+="<name>"+t+"</name>",a+="<number>"+i+"</number>"):(a+="<name>"+o.name+"</name>",a+="<number>"+o.number+"</number>"),a+="</medication>"}a+="</medications>";var r=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"/medications.xml");createFileIfNotExist(r),r.write(a)}Ti.include("../functions.js");var win=Ti.UI.currentWindow;designWindow(win,"New Medication",!1,!0),win.backgroundColor="#EFEFEF",createTabGroup(win,0);var scrollWrapper=Ti.UI.createScrollView({width:320,contentWidth:320,bottom:54});win.add(scrollWrapper);var nameLine=createField(60,"Name","text",!1,!1),dosageLine=createField(130,"Dosage","text",!1,!1),usageLine=createField(200,"Usage","text",!1,!1),withLine=createField(270,"With Meals","text",!1,!1),dateLine=createField(340,"Refil Date","date",root+"/images/appointments/date-icon.png",root+"/images/appointments/greenarrow.png"),phoneLine=createField(410,"Pharmacy Phone","number",!1,!1);scrollWrapper.add(nameLine),scrollWrapper.add(dosageLine),scrollWrapper.add(usageLine),scrollWrapper.add(withLine),scrollWrapper.add(dateLine),scrollWrapper.add(phoneLine);var saveButton=Ti.UI.createButton({width:130,height:41,backgroundImage:root+"/images/appointments/confirm-button.png",top:500,bottom:20});scrollWrapper.add(saveButton),saveButton.addEventListener("click",function(){""!=nameLine.input.value&&""!=dosageLine.input.value&&""!=usageLine.input.value&&""!=withLine.input.value&&""!=dateLine.input.value&&""!=phoneLine.input.value?(saveMedication(nameLine.input.value,dosageLine.input.value,usageLine.input.value,withLine.input.value,dateLine.input.value,phoneLine.input.value),getAlert("Your new medication has been added successfully"),win.close({animated:!0})):getAlert("All fields are required")});var datePicker=Ti.UI.createPicker({type:Ti.UI.PICKER_TYPE_DATE,bottom:-1e3,zIndex:9999999999,up:!1});win.add(datePicker),datePicker.addEventListener("change",function(){var e=datePicker.value,t=e.getMonth()+1;dateLine.input.value=t+"/"+e.getDate()+"/"+e.getFullYear()}),dateLine.input.addEventListener("click",function(){nameLine.input.blur(),dosageLine.input.blur(),usageLine.input.blur(),withLine.input.blur(),dateLine.input.blur(),phoneLine.input.blur(),0==datePicker.up?(datePicker.up=!0,datePicker.animate({bottom:0}),scrollWrapper.animate({top:-200})):(datePicker.up=!1,datePicker.animate({bottom:-1e3}),scrollWrapper.animate({top:0}))});