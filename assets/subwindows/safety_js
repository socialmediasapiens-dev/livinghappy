Ti.include("../functions.js");var win=Ti.UI.currentWindow;designWindow(win,"Safety Planning",Ti.App.userbg,!0),createTabGroup(win,0);var data=[],x=0,welcomeRow=Ti.UI.createTableViewRow({width:320,height:50,selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE}),welcomeMessage=Ti.UI.createLabel({width:300,height:34,text:sprintf("Welcome %s! How are you feeling today?",Ti.App.username),backgroundImage:root+"/images/safety/welcomebackground-transparent.png",font:{fontSize:12,fontWeight:"bold"},color:"#333",zIndex:9999,textAlign:"center"});welcomeRow.add(welcomeMessage);var seperator=Ti.UI.createTableViewRow({width:320,height:5,selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE}),goodPlanRow=Ti.UI.createTableViewRow({width:320,height:"auto",selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE}),goodPlan=Ti.UI.createView({width:320,height:116,backgroundImage:root+"/images/safety/good.png",top:0});goodPlanRow.add(goodPlan);var fairPlanRow=Ti.UI.createTableViewRow({width:320,selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE}),fairPlan=Ti.UI.createView({width:320,height:143,backgroundImage:root+"/images/safety/fair.png",top:0});fairPlanRow.add(fairPlan);var crisisPlanRow=Ti.UI.createTableViewRow({width:320,selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE}),crisisPlan=Ti.UI.createView({width:320,height:115,backgroundImage:root+"/images/safety/crisis.png",top:0});crisisPlanRow.add(crisisPlan),data[x++]=welcomeRow,data[x++]=goodPlanRow,data[x++]=seperator,data[x++]=fairPlanRow,data[x++]=seperator,data[x++]=crisisPlanRow;var safetyTable=Ti.UI.createTableView({width:320,data:data,top:54,separatorStyle:Ti.UI.iPhone.TableViewSeparatorStyle.NONE,separatorColor:"transparent",backgroundColor:"transparent",bottom:53});win.add(safetyTable);var goodPlanText=Ti.UI.createWebView({width:320,height:55,html:good_text,top:118});goodPlanTextAdded=!1;var goodPlanSep=Ti.UI.createView({width:320,height:11,backgroundImage:root+"/images/safety/additionaltext-up-arrow.png",top:108}),fairPlanText=Ti.UI.createWebView({width:320,height:170,html:fair_text,top:145});fairPlanTextAdded=!1;var fairPlanSep=Ti.UI.createView({width:320,height:11,backgroundImage:root+"/images/safety/additionaltext-up-arrow-blue.png",top:135}),crisisPlanText=Ti.UI.createView({width:320,height:230,top:117,backgroundImage:root+"/images/safety/crisis-additionaltext.png"}),crisisPlanTextLabel=Ti.UI.createWebView({html:crisis_text,top:0});crisisPlanText.add(crisisPlanTextLabel),crisisPlanTextAdded=!1;var crisisContact=Ti.UI.createButton({backgroundColor:"#27A805",backgroundImage:"",width:200,title:"Call or Text Someone!",top:150,borderRadius:8,height:30,color:"#FFFFFF",textAlign:"center",font:{fontSize:12,fontWeight:"bold"}});crisisPlanText.add(crisisContact),crisisContact.addEventListener("click",function(){var e=Ti.UI.createWindow({url:root+"/subwindows/contacts.js"});Ti.UI.currentTab.open(e)});var crisisLine=Ti.UI.createButton({backgroundColor:"#27A805",backgroundImage:"",width:200,title:"Call Crisis Line 1-877-726-4727!",top:185,borderRadius:8,height:30,color:"#FFFFFF",textAlign:"center",font:{fontSize:12,fontWeight:"bold"}});crisisPlanText.add(crisisLine),crisisLine.addEventListener("click",function(){var e=crisis_number.replace(/[^0-9]/g,"");e=e.split(" ").join(""),Ti.Platform.openURL("tel:"+e)});var crisisPlanSep=Ti.UI.createView({width:320,height:11,backgroundImage:root+"/images/safety/additionaltext-up-arrow-red.png",top:107});goodPlanRow.addEventListener("click",function(){0==goodPlanTextAdded?(safetyTable.backgroundImage=root+"/images/safety/content-blured-withheadline.png",safetyTable.setData([goodPlanRow]),this.add(goodPlanText),this.add(goodPlanSep),goodPlanText.visible=!0,goodPlanSep.visible=!0,goodPlanTextAdded=!0):(safetyTable.backgroundImage="none",this.remove(goodPlanText),this.remove(goodPlanSep),goodPlanText.visible=!1,goodPlanSep.visible=!1,goodPlanTextAdded=!1,safetyTable.setData(data))}),fairPlanRow.addEventListener("click",function(){0==fairPlanTextAdded?(safetyTable.backgroundImage=root+"/images/safety/content-blured-withheadline.png",safetyTable.setData([fairPlanRow]),this.add(fairPlanText),this.add(fairPlanSep),fairPlanText.visible=!0,fairPlanSep.visible=!0,fairPlanTextAdded=!0):(safetyTable.backgroundImage="none",this.remove(fairPlanText),fairPlanText.visible=!1,fairPlanSep.visible=!1,fairPlanTextAdded=!1,safetyTable.setData(data))}),crisisPlanRow.addEventListener("click",function(){0==crisisPlanTextAdded?(safetyTable.backgroundImage=root+"/images/safety/content-blured-withheadline.png",safetyTable.setData([crisisPlanRow]),this.add(crisisPlanText),this.add(crisisPlanSep),crisisPlanText.visible=!0,crisisPlanSep.visible=!0,crisisPlanTextAdded=!0):(safetyTable.backgroundImage="none",this.remove(crisisPlanText),crisisPlanText.visible=!1,crisisPlanSep.visible=!1,crisisPlanTextAdded=!1,safetyTable.setData(data))});