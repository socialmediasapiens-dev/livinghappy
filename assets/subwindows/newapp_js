function createField(e,t,i,a,n){var o=Ti.UI.createView({width:300,height:80,top:e}),r=Ti.UI.createLabel({font:{fontSize:10},color:"#666666",text:t,top:0,height:20,left:0});o.add(r);var c=Ti.UI.createTextField({width:300,top:25,height:40,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,paddingLeft:5,paddingRight:5});if(o.add(c),0!=a){c.paddingLeft=35;var a=Ti.UI.createImageView({left:10,image:a});switch(c.add(a),i){case"date":a.width=23,a.height=25,c.enabled=!1;break;case"time":a.width=28,a.height=23,c.enabled=!1;break;case"location":a.width=20,a.height=27}}if(0!=n&&("date"==i||"time"==i)){c.paddingRight=35;var n=Ti.UI.createImageView({right:10,image:n,width:13,height:8});c.add(n)}return o.input=c,o}function blurall(){nameLine.input.blur(),locationLine.input.blur(),1==datePicker.up&&(datePicker.up=!1,datePicker.animate({bottom:-1e3})),1==timePicker.up&&(timePicker.up=!1,timePicker.animate({bottom:-1e3}),scrollWrapper.animate({top:0}))}function saveAppoointment(e,t,i,a){var n=win.appointmentsArray,o='<?xml version="1.0" encoding="UTF-8"?><appointments>';for(var r in n){var c=n[r];o+="<appointment>",o+="<id>"+c.id+"</id>",o+="<name>"+c.name+"</name>",o+="<date>"+c.date+"</date>",o+="<time>"+c.time+"</time>",o+="<location>"+c.location+"</location>",o+="</appointment>"}o+="<appointment>",o+="<id>"+(n.length+1)+"</id>",o+="<name>"+e+"</name>",o+="<date>"+t+"</date>",o+="<time>"+i+"</time>",o+="<location>"+a+"</location>",o+="</appointment>",o+="</appointments>";var d=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"/appointments.xml");createFileIfNotExist(d),d.write(o)}Ti.include("../functions.js");var win=Ti.UI.currentWindow;designWindow(win,"Enter Appointment",!1,!0),win.backgroundColor="#EFEFEF",createTabGroup(win,0);var scrollWrapper=Ti.UI.createScrollView({width:320,contentWidth:320});win.add(scrollWrapper);var nameLine=createField(60,"Name of the person","text",!1,!1),dateLine=createField(130,"Date","date",root+"/images/appointments/date-icon.png",root+"/images/appointments/greenarrow.png"),timeLine=createField(200,"Time","time",root+"/images/appointments/time-icon.png",root+"/images/appointments/greenarrow.png"),locationLine=createField(270,"Location","location",root+"/images/appointments/location-icon.png",!1);scrollWrapper.add(nameLine),scrollWrapper.add(dateLine),scrollWrapper.add(timeLine),scrollWrapper.add(locationLine);var saveButton=Ti.UI.createButton({width:130,height:41,backgroundImage:root+"/images/appointments/confirm-button.png",top:350});scrollWrapper.add(saveButton),saveButton.addEventListener("click",function(){""!=nameLine.input.value&&""!=dateLine.input.value&&""!=timeLine.input.value&&""!=locationLine.input.value?(saveAppoointment(nameLine.input.value,dateLine.input.value,timeLine.input.value,locationLine.input.value),getAlert("Your new appointment has been added successfully"),win.close({animated:!0})):getAlert("All fields are required")});var datePicker=Ti.UI.createPicker({type:Ti.UI.PICKER_TYPE_DATE,bottom:-1e3,zIndex:9999999999,up:!1});win.add(datePicker),datePicker.addEventListener("change",function(){var e=datePicker.value,t=e.getMonth()+1;dateLine.input.value=t+"/"+e.getDate()+"/"+e.getFullYear()});var timePicker=Ti.UI.createPicker({type:Ti.UI.PICKER_TYPE_TIME,bottom:-1e3,zIndex:9999999999,up:!1});win.add(timePicker),timePicker.addEventListener("change",function(){timeLine.input.value=timePicker.value.getHours()+":"+timePicker.value.getMinutes()}),dateLine.input.addEventListener("click",function(){nameLine.input.blur(),locationLine.input.blur(),1==timePicker.up&&(timePicker.up=!1,timePicker.animate({bottom:-1e3}),scrollWrapper.animate({top:0})),0==datePicker.up?(datePicker.up=!0,datePicker.animate({bottom:0})):(datePicker.up=!1,datePicker.animate({bottom:-1e3}))}),timeLine.input.addEventListener("click",function(){nameLine.input.blur(),locationLine.input.blur(),1==datePicker.up&&(datePicker.up=!1,datePicker.animate({bottom:-1e3})),0==timePicker.up?(blurall(),timePicker.up=!0,timePicker.animate({bottom:0}),scrollWrapper.animate({top:-50})):(timePicker.up=!1,timePicker.animate({bottom:-1e3}),scrollWrapper.animate({top:0}))}),nameLine.input.addEventListener("focus",function(){locationLine.input.blur(),1==datePicker.up&&(datePicker.up=!1,datePicker.animate({bottom:-1e3})),1==timePicker.up&&(timePicker.up=!1,timePicker.animate({bottom:-1e3}),scrollWrapper.animate({top:0}))}),locationLine.input.addEventListener("focus",function(){nameLine.input.blur(),1==datePicker.up&&(datePicker.up=!1,datePicker.animate({bottom:-1e3})),1==timePicker.up&&(timePicker.up=!1,timePicker.animate({bottom:-1e3}),scrollWrapper.animate({top:0}))});