function createEditView(){var e=Ti.UI.createView({right:10,width:40,height:38}),t=Ti.UI.createImageView({width:10,height:14,right:0,backgroundImage:root+"/images/settings/arrow.png"});e.add(t);var i=Ti.UI.createLabel({left:0,text:"Edit",font:{fontSize:13},color:"#666"});return e.add(i),e}function createSaveView(){var e=Ti.UI.createView({right:10,width:50,height:38,visible:!1}),t=Ti.UI.createImageView({width:13,height:9,right:0,backgroundImage:root+"/images/settings/save.png"});e.add(t);var i=Ti.UI.createLabel({left:0,text:"Save",font:{fontSize:13},color:"#666"});return e.add(i),e}function createColorSquare(e){var t=Ti.UI.createView({width:40,height:40,backgroundColor:e,borderColor:"#000000",selected:!1,left:10,enabled:!1,borderWidth:3});return userinfoArray.color!=e?(t.visible=!1,t.borderWidth=1):t.selected=!0,t.addEventListener("click",function(){0==this.selected&&(unselectAllColors(),this.borderWidth=3,this.selected=!0)}),t}function unselectAllColors(){red.selected=!1,blue.selected=!1,green.selected=!1,purple.selected=!1,red.borderWidth=1,blue.borderWidth=1,green.borderWidth=1,purple.borderWidth=1}function getSelectedColorSquare(){var e=red;return 1==red.selected?e=red:1==green.selected?e=green:1==purple.selected?e=purple:1==blue.selected&&(e=blue),e}function showColors(e){green.visible=e,red.visible=e,purple.visible=e,blue.visible=e,red.left=10,green.left=60,purple.left=110,blue.left=160}function createAnswerTextField(e){var t=Ti.UI.createTextField({backgroundColor:"#FFFFFF",left:10,height:38,font:{fontSize:14,fontWeight:"bold"},color:"#000000",value:e,enabled:!1});return t}function createAnswerRow(){var e=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundColor:"#FFFFFF",left:0});return e}function applyEditSaveListeners(e,t,i,a){e.addEventListener("click",function(){e.visible=!1,t.visible=!0,i.enabled=!0,i.focus()}),i.addEventListener("blur",function(){i.enabled=!1,t.visible=!1,e.visible=!0,""==i.value&&(i.value=a,i.width="auto")}),t.addEventListener("click",function(){i.enabled=!1,t.visible=!1,e.visible=!0,""==i.value&&(i.value=a,i.width="auto"),saveAll()})}function saveAll(){savedWarnings=[],savedThings=[],savedWarnings[1]=answer31Text.value,savedWarnings[2]=answer32Text.value,savedWarnings[3]=answer33Text.value,savedThings[1]=answer41Text.value,savedThings[2]=answer42Text.value,savedThings[3]=answer43Text.value,Ti.App.userbg=getUserBg(getSelectedColorSquare().backgroundColor),Ti.App.username=answer1.value,headText.text="Welcome "+Ti.App.username+"\n Choose the best options that suit you",win.backgroundImage=Ti.App.userbg,saveUserInfo(answer1.value,getSelectedColorSquare().backgroundColor,savedWarnings,savedThings)}Ti.include("../functions.js");var win=Ti.UI.currentWindow;designWindow(win,"Settings",Ti.App.userbg,!1),createTabGroup(win,3);var data=[],x=0,file=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"/userinfo.xml");createFileIfNotExist(file);var xmltext=file.read().text,response=Ti.XML.parseString(xmltext),userinfoArray=[],x=0;userinfoArray.name=response.getElementsByTagName("name").item(0).text,userinfoArray.color=response.getElementsByTagName("color").item(0).text,userinfoArray.q31=response.getElementsByTagName("q31").item(0).text,userinfoArray.q32=response.getElementsByTagName("q32").item(0).text,userinfoArray.q33=response.getElementsByTagName("q33").item(0).text,userinfoArray.q41=response.getElementsByTagName("q41").item(0).text,userinfoArray.q42=response.getElementsByTagName("q42").item(0).text,userinfoArray.q43=response.getElementsByTagName("q43").item(0).text;var headline=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,width:320,height:70});data[x++]=headline;var headlineView=Ti.UI.createView({backgroundImage:root+"/images/settings/headline-background.png",width:224,height:48});headline.add(headlineView);var headText=Ti.UI.createLabel({text:"Welcome "+userinfoArray.name+"\n Choose the best options that suit you",color:"#FFFFFF",font:{fontSize:12},textAlign:"center"});headlineView.add(headText);var question1=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundImage:root+"/images/settings/questionbox-green.png",width:320,height:25,title:"I preferred to be called",font:{fontSize:14,fontWeight:"bold"},color:"#FFFFFF"});data[x++]=question1;var answer1Row=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundColor:"#FFFFFF",width:320,height:38}),answer1=Ti.UI.createTextField({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundColor:"#FFFFFF",left:10,height:38,title:"I preferred to be called",font:{fontSize:14,fontWeight:"bold"},color:"#000000",borderColor:"transparent",value:userinfoArray.name,enabled:!1}),edit1=createEditView(),save1=createSaveView();answer1Row.add(edit1),answer1Row.add(save1),applyEditSaveListeners(edit1,save1,answer1,userinfoArray.name),answer1Row.add(answer1),data[x++]=answer1Row;var question2=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundImage:root+"/images/settings/questionbox-green.png",width:320,height:25,title:"My color pereference for the App",font:{fontSize:14,fontWeight:"bold"},color:"#FFFFFF"});data[x++]=question2;var answer2Row=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundColor:"#FFFFFF",left:10,height:45}),red=createColorSquare("#D30102");answer2Row.add(red);var green=createColorSquare("#27A805");answer2Row.add(green);var purple=createColorSquare("#F5E200");answer2Row.add(purple);var blue=createColorSquare("#0575E3");answer2Row.add(blue);var edit2=createEditView(),save2=createSaveView();save2.visible=!1,answer2Row.add(edit2),answer2Row.add(save2),edit2.addEventListener("click",function(){edit2.visible=!1,save2.visible=!0,showColors(!0)}),save2.addEventListener("click",function(){save2.visible=!1,edit2.visible=!0,showColors(!1),getSelectedColorSquare().left=10,getSelectedColorSquare().visible=!0,saveAll()}),data[x++]=answer2Row;var question3=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundImage:root+"/images/settings/questionbox-green.png",width:320,height:25,title:"My warning signs",font:{fontSize:14,fontWeight:"bold"},color:"#FFFFFF"});data[x++]=question3;var answer31=createAnswerRow(),answer32=createAnswerRow(),answer33=createAnswerRow(),answer31Text=createAnswerTextField(userinfoArray.q31),answer32Text=createAnswerTextField(userinfoArray.q32),answer33Text=createAnswerTextField(userinfoArray.q33),edit31=createEditView(),edit32=createEditView(),edit33=createEditView(),save31=createSaveView(),save32=createSaveView(),save33=createSaveView();answer31.add(answer31Text),answer31.add(edit31),answer31.add(save31),answer32.add(answer32Text),answer32.add(edit32),answer32.add(save32),answer33.add(answer33Text),answer33.add(edit33),answer33.add(save33),data[x++]=answer31,data[x++]=answer32,data[x++]=answer33,applyEditSaveListeners(edit31,save31,answer31Text,userinfoArray.q31),applyEditSaveListeners(edit32,save32,answer32Text,userinfoArray.q32),applyEditSaveListeners(edit33,save33,answer33Text,userinfoArray.q33);var question4=Ti.UI.createTableViewRow({selectionStyle:Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,backgroundImage:root+"/images/settings/questionbox-green.png",width:320,height:25,title:"Things I do to take my mind off my problems",font:{fontSize:14,fontWeight:"bold"},color:"#FFFFFF"});data[x++]=question4;var answer41=createAnswerRow(),answer42=createAnswerRow(),answer43=createAnswerRow(),answer41Text=createAnswerTextField(userinfoArray.q41),answer42Text=createAnswerTextField(userinfoArray.q42),answer43Text=createAnswerTextField(userinfoArray.q43),edit41=createEditView(),edit42=createEditView(),edit43=createEditView(),save41=createSaveView(),save42=createSaveView(),save43=createSaveView();answer41.add(answer41Text),answer41.add(edit41),answer41.add(save41),answer42.add(answer42Text),answer42.add(edit42),answer42.add(save42),answer43.add(answer43Text),answer43.add(edit43),answer43.add(save43),data[x++]=answer41,data[x++]=answer42,data[x++]=answer43,applyEditSaveListeners(edit41,save41,answer41Text,userinfoArray.q41),applyEditSaveListeners(edit42,save42,answer42Text,userinfoArray.q42),applyEditSaveListeners(edit43,save43,answer43Text,userinfoArray.q43);var settingsTable=Ti.UI.createTableView({width:320,height:"auto",separatorStyle:Ti.UI.iPhone.TableViewSeparatorStyle.NONE,separatorColor:"transparent",backgroundColor:"transparent",data:data,bottom:50,top:50});win.add(settingsTable);